//////////////////////////////////////////////////////////////////////////////////////////////
// DO NOT MODIFY THIS FILE                                                                  //
// This file is automatically generated by ZenStack CLI and should not be manually updated. //
//////////////////////////////////////////////////////////////////////////////////////////////

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum SocialPlatform {
  FACEBOOK
  INSTAGRAM
  TIKTOK
  YOUTUBE
  TWITTER
}

enum AccountType {
  PAGE
  GROUP
  PROFILE
  BUSINESS
  CREATOR
}

enum VideoStatus {
  PENDING
  PROCESSING
  READY
  FAILED_PROCESSING
}

enum PublishingJobStatus {
  PENDING
  PROCESSING
  COMPLETED
  FAILED
  PARTIALLY_COMPLETED
}

enum PublishingTaskStatus {
  PENDING
  UPLOADING
  PUBLISHED
  FAILED
  RETRYING
}

model User {
  id               String          @id() @default(uuid())
  email            String          @unique()
  username         String          @unique()
  password         String?
  profilePicture   String?         @map("profile_picture")
  resetToken       String?         @map("reset_token")
  resetTokenExpiry DateTime?       @map("reset_token_expiry")
  createdAt        DateTime        @default(now()) @map("created_at")
  updatedAt        DateTime        @updatedAt() @map("updated_at")
  deletedAt        DateTime?       @map("deleted_at")
  createdBy        String?         @map("created_by")
  updatedBy        String?         @map("updated_by")
  deletedBy        String?         @map("deleted_by")
  socialAccounts   SocialAccount[]
  videos           Video[]
  publishingJobs   PublishingJob[]
  socialApps       SocialApp[]

  @@map("users")
}

model SocialAccount {
  id              String           @id() @default(uuid())
  platform        SocialPlatform
  accountType     AccountType      @map("account_type")
  accountId       String           @map("account_id")
  accountName     String           @map("account_name")
  accessToken     String           @map("access_token")
  refreshToken    String?          @map("refresh_token")
  expiresAt       DateTime?        @map("expires_at")
  profilePicture  String?          @map("profile_picture")
  isActive        Boolean          @default(true) @map("is_active")
  metadata        Json?
  userId          String           @map("user_id")
  socialAppId     String           @map("social_app_id")
  createdAt       DateTime         @default(now()) @map("created_at")
  updatedAt       DateTime         @updatedAt() @map("updated_at")
  deletedAt       DateTime?        @map("deleted_at")
  createdBy       String?          @map("created_by")
  updatedBy       String?          @map("updated_by")
  deletedBy       String?          @map("deleted_by")
  user            User             @relation(fields: [userId], references: [id])
  socialApp       SocialApp        @relation(fields: [socialAppId], references: [id])
  publishingTasks PublishingTask[]

  @@unique([platform, accountId, userId])
  @@map("social_accounts")
}

model Video {
  id              String           @id() @default(uuid())
  title           String
  description     String?
  filePath        String           @map("file_path")
  thumbnailPath   String?          @map("thumbnail_path")
  duration        Int?
  status          VideoStatus      @default(PENDING)
  userId          String           @map("user_id")
  createdAt       DateTime         @default(now()) @map("created_at")
  updatedAt       DateTime         @updatedAt() @map("updated_at")
  deletedAt       DateTime?        @map("deleted_at")
  createdBy       String?          @map("created_by")
  updatedBy       String?          @map("updated_by")
  deletedBy       String?          @map("deleted_by")
  user            User             @relation(fields: [userId], references: [id])
  publishingTasks PublishingTask[]

  @@map("videos")
}

model PublishingJob {
  id           String              @id() @default(uuid())
  name         String
  description  String?
  status       PublishingJobStatus @default(PENDING)
  scheduleTime DateTime?           @map("schedule_time")
  userId       String              @map("user_id")
  createdAt    DateTime            @default(now()) @map("created_at")
  updatedAt    DateTime            @updatedAt() @map("updated_at")
  deletedAt    DateTime?           @map("deleted_at")
  createdBy    String?             @map("created_by")
  updatedBy    String?             @map("updated_by")
  deletedBy    String?             @map("deleted_by")
  user         User                @relation(fields: [userId], references: [id])
  tasks        PublishingTask[]

  @@map("publishing_jobs")
}

model PublishingTask {
  id              String               @id() @default(uuid())
  status          PublishingTaskStatus @default(PENDING)
  error           String?
  jobId           String               @map("job_id")
  videoId         String               @map("video_id")
  socialAccountId String               @map("social_account_id")
  createdAt       DateTime             @default(now()) @map("created_at")
  updatedAt       DateTime             @updatedAt() @map("updated_at")
  deletedAt       DateTime?            @map("deleted_at")
  createdBy       String?              @map("created_by")
  updatedBy       String?              @map("updated_by")
  deletedBy       String?              @map("deleted_by")
  job             PublishingJob        @relation(fields: [jobId], references: [id])
  video           Video                @relation(fields: [videoId], references: [id])
  socialAccount   SocialAccount        @relation(fields: [socialAccountId], references: [id])

  @@map("publishing_tasks")
}

model SocialApp {
  id             String          @id() @default(cuid())
  name           String
  platform       SocialPlatform
  appId          String          @map("app_id")
  appSecret      String          @map("app_secret")
  redirectUri    String          @map("redirect_uri")
  isDefault      Boolean         @default(false) @map("is_default")
  userId         String          @map("user_id")
  createdAt      DateTime        @default(now()) @map("created_at")
  updatedAt      DateTime        @updatedAt() @map("updated_at")
  deletedAt      DateTime?       @map("deleted_at")
  createdBy      String?         @map("created_by")
  updatedBy      String?         @map("updated_by")
  deletedBy      String?         @map("deleted_by")
  user           User            @relation(fields: [userId], references: [id])
  socialAccounts SocialAccount[]

  @@map("social_apps")
}
